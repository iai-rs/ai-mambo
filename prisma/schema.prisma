generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model users {
  id                         String  @id @db.VarChar(255)
  name                       String  @db.VarChar(255)
  email                      String  @unique @db.VarChar(255)
  password                   String? @db.VarChar(255)
  change_password_secret_key String? @db.VarChar(255)
  role                       Role    @default(USER)
}

model DicomMetadata {
  mammography_id     String        @id @default(uuid())
  patient_name       String?
  patient_id         String
  acquisition_date   String?
  acquisition_time   String?
  view               String?
  laterality         String?
  implant            String?
  manufacturer       String?
  manufacturer_model String?
  institution        String?
  biradsResults      BiradsResults @relation(fields: [mammography_id], references: [study_uid])

  @@map("dicom_metadata")
}

model BiradsResults {
  study_uid      String          @unique
  model_1_result Decimal         @db.Decimal
  patient_name   String?         @db.VarChar(255)
  id             Int             @id @default(autoincrement())
  dicomMetadata  DicomMetadata?
  feedback       BiradsFeedback?

  @@map("birads_results")
}

model BiradsFeedback {
  id                  Int                   @id @default(autoincrement())
  study_uid           String                @unique
  suspect_lesion      Boolean
  shadow              Boolean
  microcalcifications Boolean
  symmetry            Boolean
  architectonics      Boolean
  birads_class        birads_classification
  user_email          String
  biradsResults       BiradsResults         @relation(fields: [study_uid], references: [study_uid], map: "birads_feedback_study_uid_fkey")

  @@map("birads_feedback")
}

enum Role {
  USER
  ADMIN
}

enum birads_classification {
  birads_0  @map("0")
  birads_1  @map("1")
  birads_2  @map("2")
  birads_3  @map("3")
  birads_4a @map("4a")
  birads_4b @map("4b")
  birads_4c @map("4c")
  birads_5  @map("5")
  birads_6  @map("6")
}